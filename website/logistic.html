<!DOCTYPE html>
<html lang="en-us">

<head>
  <link rel="icon" href="resources/heart.png"
  <meta charset="UTF-8">
  <title>ML  & Heart Disease</title>

 <!-- Bring in our bootstrap stylesheet -->

 
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

 <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
 <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

 <link rel="stylesheet" href="style.css">
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <img src="resources/beat.gif" height="42" width="42">
        <a class="navbar-brand" href="index.html">ML Heart</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>    
      
        <div class="collapse navbar-collapse" id="navbarColor01">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="etl.html">ETL on Data</a>
              </li>
            <li class="nav-item dropdown active">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  ML Models
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="forest.html">Random Forest</a>
                  <a class="dropdown-item active" href="logistic.html">Logistic Regression </a>
                  <a class="dropdown-item" href="neural.html">Neural Net</a>
                  <a class="dropdown-item" href="knearest.html">K Nearest Neighbors</a>
                  <a class="dropdown-item" href="vector.html">Support Vector Machine</a>
                </div>
              </li>

            <li class="nav-item">
              <a class="nav-link"href="analysis.html">Analysis</a>
            </li>
          </ul>
          </div>
        </nav>
  <div class="container">


  
      <!-- Row 1 -->
      <div class="row">
        <div class="col-12 col-sm-12 col-md-12">
            <div class="jumbotron">
              <h1><strong>Logistic Regression Algorithm</strong></h1>
              <p><strong>Introduction</strong></p>
              <p>Logistic Regression is a classification algorithm used to assign observations to a discrete set of classes. Some of the examples of classification problems are Email spam or not spam, Online transactions Fraud or not Fraud, Tumor Malignant or Benign. Logistic regression transforms its output using the logistic sigmoid function to return a probability value.</p>
              
              <p>We can call a Logistic Regression a Linear Regression model but the Logistic Regression uses a more complex cost function, this cost function can be defined as the ‘Sigmoid function’ or also known as the ‘logistic function’ instead of a linear function.</p>
              <p>The hypothesis of logistic regression tends it to limit the cost function between 0 and 1. Therefore linear functions fail to represent it as it can have a value greater than 1 or less than 0 which is not possible as per the hypothesis of logistic regression.</p>
              <p><strong>What is the Sigmoid Function?</strong></p>
              <p>In order to map predicted values to probabilities, we use the Sigmoid function. The function maps any real value into another value between 0 and 1. In machine learning, we use sigmoid to map predictions to probabilities.
                <center><img src="resources/LR-image1.png" alt="LR image1"></center>
              </p>
              <p><strong>Implementation on the Heart Disease dataset</strong></p>
<p>The scikit learn library implementation of Logistic Regression provides multiple settings to tune a model. &nbsp;Using the Heart Disease data set, four settings were tested as follows using a nested for loops to test all combinations a total of 10 times each:</p>
<p>&nbsp;</p>
<ul>
  <li><strong>Tolerances = [0.1, 0.001, 0.00001, 0.0000001]</strong></li>
  <li><strong>Weights = ['balanced','none']</strong></li>
  <li><strong>Maximum Iterations = [10, 50, 100, 500]</strong></li>
  <li><strong>Solvers = ['newton-cg', 'lbfgs', 'sag', 'saga', 'liblinear']</strong></li>
</ul>
<p><strong>&nbsp;</strong></p>
<p>Results were captured and displayed in a data frame:
  <center><img src="resources/LR-table1.png" alt="LR table1"></center>
  <p></p>All scores were plotted in run order:</p>
  <center><img src="resources/LR-image2.png" alt="LR image2"></center>
</p>
<p>Results were grouped by the four variables and plotted vs the Average Score: </p>
<center><img src="resources/LR-table2.png" alt="LR table2"></center>
<center><img src="resources/LR-image3.png" alt="LR image3"></center>
<p>Finally, the max Avg, Train and Test scores were calculated and the data set was reduced to only rows that contain at least one these max values:</p>
<center><img src="resources/LR-table3.png" alt="LR table3"></center>
<p>These values were then plotted by their index value.</p>
<center><img src="resources/LR-image4.png" alt="LR image4"></center>
<p>Based on the results, sample 1142 was chosen as it has the most consistent scores for all three and the highest for the Train set.</p>
<p>&nbsp;</p>
<p>The following model was then selected:</p>
<ul>
  <li><strong>Tolerance = 0.0000001</strong></li>
  <li><strong>Weight = 'balanced'</strong></li>
  <li><strong>Max Iterations = 10</strong></li>
  <li><strong>Solver = 'sag'</strong></li>
</ul>
<p>&nbsp;</p>
<p>Finally, the test data was run with the new model. &nbsp;The results were broken into ‘same’ (correct) and ‘differences’ (incorrect) populations. &nbsp;They were then plotted vs each variable feature. &nbsp;The mean (ANOVA, Kruskal) and the variation (Student t) of the two populations were checked to ensure they were not different. &nbsp;If they had been, we may have had a problem / opportunity with our model. &nbsp;A sample of the analysis is shown below for max heart rate:</p>
<center><img src="resources/LR-image5.png" alt="LR image5"></center>
        </div>
    </div>
      </div>
      </div>
</body>
</html>